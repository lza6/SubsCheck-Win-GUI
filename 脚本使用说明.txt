========================================
  SubsCheck Win GUI - 脚本使用说明
========================================

一、清理环境.bat
----------------
功能：全面清理项目环境，用于快速测试和重置

选项：
1. 完全清理环境
   - 删除所有编译输出目录（bin、obj）
   - 清理配置文件（自动备份为 .backup）
   - 清理临时文件和下载文件
   - 适用于需要完全重置环境的情况

2. 仅清理编译输出
   - 只删除 bin 和 obj 目录
   - 保留配置文件
   - 适用于重新编译前清理

3. 仅清理配置文件
   - 删除 config.yaml 和 more.yaml
   - 自动备份 config.yaml 为 config.yaml.backup
   - 适用于重置配置

4. 仅清理临时文件
   - 清理 output 目录中的测试结果
   - 删除临时 zip 文件
   - 适用于清理下载缓存

5. 重置为默认配置
   - 创建默认的 config.yaml
   - 适用于恢复初始状态

使用场景：
- 编译前清理：选择选项 2
- 配置出错：选择选项 5
- 完全重置：选择选项 1


二、快速测试.bat
----------------
功能：快速配置和测试不同的代理模式

选项：
1. 测试 GitHub 代理模式
   - 配置 use-local-proxy: false
   - 程序会优先使用 GitHub 代理
   - 测试 GitHub 代理的可用性和速度

2. 测试本地代理模式
   - 配置 use-local-proxy: true
   - 程序会直接使用本地代理（V2Ray/Clash）
   - 跳过 GitHub 代理检测
   - 前提：需要启动本地代理软件

3. 测试智能回退模式
   - 配置 use-local-proxy: false
   - 程序先尝试 GitHub 代理
   - GitHub 代理失败时自动切换到本地代理
   - 本地代理也不可用时显示警告
   - 推荐测试场景：关闭本地代理，观察自动回退

4. 清理编译输出并重新编译
   - 清理 bin 和 obj 目录
   - 自动调用快速启动脚本编译

5. 运行清理工具
   - 启动清理环境.bat

6. 启动程序
   - 启动编译好的程序
   - 如果未编译，提示是否重新编译

使用场景：
- 测试 GitHub 代理：选择选项 1，然后选项 6
- 测试本地代理：启动 V2Ray/Clash，选择选项 2，然后选项 6
- 测试智能回退：选择选项 3，然后选项 6
- 重新编译：选择选项 4


三、测试建议
----------------

1. 测试 GitHub 代理模式
   - 确保网络连接正常
   - 选择快速测试.bat 的选项 1
   - 启动程序，观察日志中的代理检测结果
   - 查看是否成功使用 GitHub 代理

2. 测试本地代理模式
   - 先启动您的 V2Ray 或 Clash 代理软件
   - 确保代理端口为常见端口（10808、10809、7890 等）
   - 选择快速测试.bat 的选项 2
   - 启动程序，观察是否成功检测到本地代理
   - 查看日志中的本地代理状态（端口、IP等）

3. 测试智能回退模式
   - 步骤1：关闭本地代理软件
   - 步骤2：选择快速测试.bat 的选项 3
   - 步骤3：启动程序，观察 GitHub 代理检测
   - 步骤4：如果 GitHub 代理失败，观察是否自动切换
   - 步骤5：启动本地代理，重新启动程序，观察自动切换回本地代理


四、智能代理逻辑说明
----------------

GitHub 代理模式（use-local-proxy: false）：
- 优先测试 GitHub 代理可用性
- 如果 GitHub 代理可用：使用 GitHub 代理
- 如果 GitHub 代理全部不可用：自动切换到本地代理
- 自动检测本地代理（10808、10809、7890 等端口）
- 如果检测到本地代理：使用原生 GitHub 链接 + 本地代理
- 如果未检测到本地代理：警告用户，但仍尝试原生链接

本地代理模式（use-local-proxy: true）：
- 跳过 GitHub 代理检测
- 直接使用原生 GitHub 链接
- 所有订阅链接保持原始状态
- 适用于已经配置好本地代理的情况

适用场景：
- GitHub 代理可用：使用 GitHub 代理模式
- GitHub 代理不稳定：使用智能回退模式
- 本地代理稳定：使用本地代理模式
- 需要测试：使用快速测试.bat 快速切换


五、常见问题
----------------

Q: 为什么程序还是使用了 GitHub 代理？
A: 请检查配置文件中的 use-local-proxy 选项，确保为 true

Q: 为什么没有检测到本地代理？
A: 请确保：
   - 本地代理软件已启动
   - 代理端口为常见端口（10808、10809、7890、7891 等）
   - 代理支持 HTTP 代理协议

Q: GitHub 代理失败后没有自动切换？
A: 请检查：
   - 配置文件中 use-local-proxy 是否为 false
   - 本地代理是否已启动
   - 查看日志中的具体错误信息

Q: 如何查看代理检测结果？
A: 启动程序后，在实时日志中查看：
   - "开始检测 X 个 GitHub 代理..."
   - "代理检测结果:"
   - "选择延迟最低的代理: ..."
   - "✓ 本地代理检测成功: ..."

Q: 配置文件在哪里？
A: 配置文件位置：bin\Debug\config\config.yaml


六、快速开始
----------------

1. 首次使用：
   - 运行"快速测试.bat"
   - 选择选项 3（智能回退模式）
   - 然后选择选项 6（启动程序）

2. 测试本地代理：
   - 启动您的 V2Ray/Clash
   - 运行"快速测试.bat"
   - 选择选项 2（本地代理模式）
   - 然后选择选项 6（启动程序）

3. 重新编译：
   - 运行"快速测试.bat"
   - 选择选项 4（清理并重新编译）

4. 清理环境：
   - 运行"清理环境.bat"
   - 根据需要选择清理选项


========================================
  版本：1.0
  更新日期：2026-02-05
========================================